{
  "version": 3,
  "sources": ["../../../../../../../apps/kiosk-server/src/services/db.query.ts"],
  "sourcesContent": ["import pool from '../db';\n\nexport const getDonationCount = async (eventId) => {\n  const sql = `SELECT count(*) FROM tbl_donations  WHERE \"eventId\" = '${eventId}'`;\n  const { rows } = await pool.query(sql);\n  return rows?.[0] || { count: '0' };\n};\n\nexport const getAgeStats = async (eventID) => {\n  const sql = `SELECT\n  COUNT(*) FILTER (WHERE EXTRACT(YEAR FROM AGE(\"dop\")) <= 20) AS \"20 under\",\n  COUNT(*) FILTER (WHERE EXTRACT(YEAR FROM AGE(\"dop\")) BETWEEN 21 AND 25) AS \"20 to 25\",\n  COUNT(*) FILTER (WHERE EXTRACT(YEAR FROM AGE(\"dop\")) BETWEEN 26 AND 30) AS \"25 to 30\",\n  COUNT(*) FILTER (WHERE EXTRACT(YEAR FROM AGE(\"dop\")) BETWEEN 31 AND 40) AS \"30 to 40\",\n  COUNT(*) FILTER (WHERE EXTRACT(YEAR FROM AGE(\"dop\")) BETWEEN 41 AND 50) AS \"40 to 50\",\n  COUNT(*) FILTER (WHERE EXTRACT(YEAR FROM AGE(\"dop\")) BETWEEN 51 AND 60) AS \"50 to 60\",\n  COUNT(*) FILTER (WHERE EXTRACT(YEAR FROM AGE(\"dop\")) >= 61) AS \"60+\"\nFROM tbl_donors\nWHERE \"uuid\" IN (\n    SELECT \"donorId\"\n    FROM tbl_donations\n    WHERE \"eventId\" = '${eventID}'\n);`;\n  const { rows } = await pool.query(sql);\n  return (\n    rows?.[0] || {\n      '20 under': '0',\n      '20 to 25': '0',\n      '25 to 30': '0',\n      '30 to 40': '0',\n      '40 to 50': '0',\n      '50 to 60': '0',\n      '60+': '0',\n    }\n  );\n};\n\nexport const getGenderStats = async (eventId) => {\n  const sql = `SELECT\n  COUNT(*) FILTER (WHERE \"gender\" = 'MALE') AS \"Male\",\n  COUNT(*) FILTER (WHERE \"gender\" = 'FEMALE') AS \"Female\",\n  COUNT(*) FILTER (WHERE \"gender\" = 'OTHER') AS \"Other\"\nFROM tbl_donors\nWHERE \"uuid\" IN (\n    SELECT \"donorId\"\n    FROM tbl_donations\n    WHERE \"eventId\" = '${eventId}'\n);`;\n  const { rows } = await pool.query(sql);\n  return rows?.[0] || { count: '0' };\n};\n\nexport const getBloodGroupStats = async (eventId) => {\n  const sql = `SELECT\n  COUNT(*) FILTER (WHERE \"bloodInfo\"->>'group' = 'A_POSITIVE') AS \"A_POSITIVE\",\n  COUNT(*) FILTER (WHERE \"bloodInfo\"->>'group' = 'B_POSITIVE') AS \"B_POSITIVE\",\n  COUNT(*) FILTER (WHERE \"bloodInfo\"->>'group' = 'AB_POSITIVE') AS \"AB_POSITIVE\",\n  COUNT(*) FILTER (WHERE \"bloodInfo\"->>'group' = 'O_POSITIVE') AS \"O_POSITIVE\",\n  COUNT(*) FILTER (WHERE \"bloodInfo\"->>'group' = 'A_NEGATIVE') AS \"A_NEGATIVE\",\n  COUNT(*) FILTER (WHERE \"bloodInfo\"->>'group' = 'B_NEGATIVE') AS \"B_NEGATIVE\",\n  COUNT(*) FILTER (WHERE \"bloodInfo\"->>'group' = 'AB_NEGATIVE') AS \"AB_NEGATIVE\",\n  COUNT(*) FILTER (WHERE \"bloodInfo\"->>'group' = 'O_NEGATIVE') AS \"O_NEGATIVE\"\nFROM tbl_donors\nWHERE \"uuid\" IN (\n    SELECT \"donorId\"\n    FROM tbl_donations\n    WHERE \"eventId\" = '${eventId}'\n);`;\n  const { rows } = await pool.query(sql);\n  return rows?.[0] || { count: '0' };\n};\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAiB;AAEV,MAAM,mBAAmB,OAAO,YAAY;AACjD,QAAM,MAAM,0DAA0D,OAAO;AAC7E,QAAM,EAAE,KAAK,IAAI,MAAM,UAAAA,QAAK,MAAM,GAAG;AACrC,SAAO,OAAO,CAAC,KAAK,EAAE,OAAO,IAAI;AACnC;AAEO,MAAM,cAAc,OAAO,YAAY;AAC5C,QAAM,MAAM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yBAYW,OAAO;AAAA;AAE9B,QAAM,EAAE,KAAK,IAAI,MAAM,UAAAA,QAAK,MAAM,GAAG;AACrC,SACE,OAAO,CAAC,KAAK;AAAA,IACX,YAAY;AAAA,IACZ,YAAY;AAAA,IACZ,YAAY;AAAA,IACZ,YAAY;AAAA,IACZ,YAAY;AAAA,IACZ,YAAY;AAAA,IACZ,OAAO;AAAA,EACT;AAEJ;AAEO,MAAM,iBAAiB,OAAO,YAAY;AAC/C,QAAM,MAAM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yBAQW,OAAO;AAAA;AAE9B,QAAM,EAAE,KAAK,IAAI,MAAM,UAAAA,QAAK,MAAM,GAAG;AACrC,SAAO,OAAO,CAAC,KAAK,EAAE,OAAO,IAAI;AACnC;AAEO,MAAM,qBAAqB,OAAO,YAAY;AACnD,QAAM,MAAM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yBAaW,OAAO;AAAA;AAE9B,QAAM,EAAE,KAAK,IAAI,MAAM,UAAAA,QAAK,MAAM,GAAG;AACrC,SAAO,OAAO,CAAC,KAAK,EAAE,OAAO,IAAI;AACnC;",
  "names": ["pool"]
}
